================================================================================
COMPREHENSIVE EMBEDDING AND SOLVING BENCHMARK v2.0
================================================================================
Testing: Formulations × Decompositions × Solvers
================================================================================

[1/6] Importing libraries...
  [OK] Real data loaders available (scenarios, farm_sampler, patch_sampler)
  [OK] Imports done in 3.88s

================================================================================
COMPREHENSIVE EMBEDDING AND SOLVING BENCHMARK v2.0
================================================================================

[1/4] Initializing...
  Using simulated Pegasus P16 topology
  [OK] Target graph: 5640 nodes, 40484 edges
  Total configurations to test: 15
  Problem sizes: [25]
  Formulations: ['CQM', 'BQM', 'SparseBQM']
  Decompositions: ['None', 'Louvain', 'PlotBased', 'Multilevel', 'Cutset', 'SpatialGrid', 'EnergyImpact']

[2/4] Running experiments...

============================================================
PROBLEM SIZE: 25 farms × 27 foods = 675 variables
============================================================

  [1/15] n_farms=25, form=CQM, decomp=None
    Building CQM...
    Building Patch CQM (25 patches, 27 foods) with REAL data...
  Loading real food data from 'full_family' scenario...
Loading food data from: /Users/edoardospigarolo/Documents/OQI-UC002-DWave/Inputs/Combined_Food_Data.xlsx
    Loaded 27 foods, 5 food groups
    Weights: {'nutritional_value': 0.25, 'nutrient_density': 0.2, 'environmental_impact': 0.25, 'affordability': 0.15, 'sustainability': 0.15}
    Solving CQM with Gurobi (no embedding for CQM)...
      Solving CQM (675 vars, 26 constraints)...
        [1/5] Creating Gurobi model...
Set parameter Username
Set parameter LicenseID to value 2728803
Academic license - for non-commercial use only - expires 2026-10-28
        [2/5] Adding variables...
        [3/5] Building objective (675 linear, 0 quadratic)...
        [4/5] Adding 26 constraints...
        [5/5] Optimizing...
        [DONE] in 0.03s (status=2)

  [2/15] n_farms=25, form=BQM, decomp=None
    Building BQM...
    Building Patch CQM (25 patches, 27 foods) with REAL data...
    Converting Patch_CQM to BQM...
    Applying decomposition: None...
      Created 1 partition(s)
    Running embedding study...
      Testing embedding: 760 vars, 236370 edges (density=0.409)
      Running minorminer (timeout=300s)...
      [FAILED] No embedding (tried for 747.1s)
    Solving with Gurobi...
      Solving BQM (760 vars, 236370 quad)...
        Creating model and optimizing...
        [DONE] in 100.29s (TIME_LIMIT, bqm_energy=-0.6091)
      Actual objective: 0.609081 (BQM energy: -0.6091)
    Result: Embed=[NO] (747.1s), Solve=[PARTIAL] (100.3s) [timeout], Total=847.3s

  [3/15] n_farms=25, form=BQM, decomp=Louvain
    Building BQM...
    Building Patch CQM (25 patches, 27 foods) with REAL data...
    Converting Patch_CQM to BQM...
    Applying decomposition: Louvain...
      Created 6 partition(s)
    Running embedding study...
      Embedding 6 partitions...
        Partition 1/6 (130 vars)...
      Testing embedding: 130 vars, 7239 edges (density=0.428)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 305.6s (chains: max=20, mean=14.1)
        Partition 2/6 (150 vars)...
      Testing embedding: 150 vars, 9465 edges (density=0.421)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 144.5s (chains: max=33, mean=17.5)
        Partition 3/6 (150 vars)...
      Testing embedding: 150 vars, 9465 edges (density=0.421)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 79.2s (chains: max=34, mean=16.4)
        Partition 4/6 (150 vars)...
      Testing embedding: 150 vars, 9465 edges (density=0.421)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 171.1s (chains: max=41, mean=19.9)
        Partition 5/6 (150 vars)...
      Testing embedding: 150 vars, 9465 edges (density=0.421)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 252.1s (chains: max=25, mean=16.3)
        Partition 6/6 (30 vars)...
      Testing embedding: 30 vars, 435 edges (density=0.483)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 3.1s (chains: max=6, mean=4.2)
    Solving with Gurobi...
      Solving 6 partitions with Gurobi...
      Solving BQM (130 vars, 7239 quad)...
        Creating model and optimizing...
        [DONE] in 100.01s (TIME_LIMIT, bqm_energy=-4557250.2520)
      Solving BQM (150 vars, 9465 quad)...
        Creating model and optimizing...
        [DONE] in 0.03s (OPTIMAL, bqm_energy=-1617301.1969)
      Solving BQM (150 vars, 9465 quad)...
        Creating model and optimizing...
        [DONE] in 0.03s (OPTIMAL, bqm_energy=-1617301.1969)
      Solving BQM (150 vars, 9465 quad)...
        Creating model and optimizing...
        [DONE] in 0.03s (OPTIMAL, bqm_energy=-1617301.1969)
      Solving BQM (150 vars, 9465 quad)...
        Creating model and optimizing...
        [DONE] in 0.03s (OPTIMAL, bqm_energy=-1617301.1969)
      Solving BQM (30 vars, 435 quad)...
        Creating model and optimizing...
        [DONE] in 0.00s (OPTIMAL, bqm_energy=-352620.2394)
      Actual objective: 0.000000 (BQM energy: -11379075.2789)
    Result: Embed=[OK] (955.5s), Solve=[PARTIAL] (100.1s) [5/6 optimal, 1 timeout], Total=1055.7s

  [4/15] n_farms=25, form=BQM, decomp=PlotBased
    Building BQM...
    Building Patch CQM (25 patches, 27 foods) with REAL data...
    Converting Patch_CQM to BQM...
    Applying decomposition: PlotBased...
      Created 5 partition(s)
    Running embedding study...
      Embedding 5 partitions...
        Partition 1/5 (135 vars)...
      Testing embedding: 135 vars, 9045 edges (density=0.496)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 307.7s (chains: max=32, mean=19.7)
        Partition 2/5 (135 vars)...
      Testing embedding: 135 vars, 9045 edges (density=0.496)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 306.9s (chains: max=32, mean=20.0)
        Partition 3/5 (135 vars)...
      Testing embedding: 135 vars, 9045 edges (density=0.496)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 308.1s (chains: max=31, mean=20.3)
        Partition 4/5 (135 vars)...
      Testing embedding: 135 vars, 9045 edges (density=0.496)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 301.7s (chains: max=27, mean=18.6)
        Partition 5/5 (135 vars)...
      Testing embedding: 135 vars, 9045 edges (density=0.496)
      Running minorminer (timeout=300s)...
      [SUCCESS] Embedded in 302.7s (chains: max=30, mean=19.7)
    Solving with Gurobi...
      Solving 5 partitions with Gurobi...
      Solving BQM (135 vars, 9045 quad)...
        Creating model and optimizing...
        [DONE] in 0.03s (OPTIMAL, bqm_energy=-1617301.1969)
      Solving BQM (135 vars, 9045 quad)...
        Creating model and optimizing...
        [DONE] in 0.03s (OPTIMAL, bqm_energy=-1617301.1969)
      Solving BQM (135 vars, 9045 quad)...
        Creating model and optimizing...
        [DONE] in 0.03s (OPTIMAL, bqm_energy=-1617301.1969)
      Solving BQM (135 vars, 9045 quad)...
        Creating model and optimizing...
        [DONE] in 0.03s (OPTIMAL, bqm_energy=-1617301.1969)
      Solving BQM (135 vars, 9045 quad)...
        Creating model and optimizing...
        [DONE] in 0.03s (OPTIMAL, bqm_energy=-1617301.1969)
      Actual objective: 0.000000 (BQM energy: -8086505.9844)
    Result: Embed=[OK] (1527.2s), Solve=[OK] (0.1s) [5/5 optimal], Total=1527.3s

  [5/15] n_farms=25, form=BQM, decomp=Multilevel
    Building BQM...
    Building Patch CQM (25 patches, 27 foods) with REAL data...
    Converting Patch_CQM to BQM...
    Applying decomposition: Multilevel...
      Created 2 partition(s)
    Running embedding study...
      Embedding 2 partitions...
        Partition 1/2 (400 vars)...
      Testing embedding: 400 vars, 66272 edges (density=0.414)
      Running minorminer (timeout=300s)...
      [FAILED] No embedding (tried for 535.5s)
        Partition 2/2 (360 vars)...
      Testing embedding: 360 vars, 52203 edges (density=0.403)
      Running minorminer (timeout=300s)...
